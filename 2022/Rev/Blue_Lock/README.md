# Blue Lock

### Challenge Description

There was a breach within the system, our antivirus engines tagged the executable with 0 red flags. Although behaviour analysis suggests the executable could be a live malware. Unsure about what it does, we have handed it over to you. We also provide you with an additional file, we are unsure about the use case of it.

Here is something we noticed which might help you, the executable is capable of destroying its previous state, we noticed it overwrites the file it came with. 

Note: This is a live malware, advised to run it within a VM to avoid side effects.

Password: infected

**Challenge File**:
+ [Primary Link](https://drive.google.com/file/d/1tyQC5P7hYYjCTZcptn8-NCdierANnQ31/view?usp=share_link)
+ [Mirror Link]()

**MD5 Hash**: 

+ *malware.exe*: 24eef97454e68492f7b8881379da827c
+ *enc_file*: 52a1995b64b46aa9881e064c4ce877d6

### Short Writeup

+  Challenge is based on process hollowing, use automated tools like pe seive or use breakpoints to break at resume thread, and extract the inner binary.
+  First Stage has SEH exception handlers implemented within it in order to thwart static and dynamic analysis.
+  Second Stage has VEH exception handlers implemented, with xxtea ciper.
+  Multiple runtime API decryption, runtime constant decryption, runtime string decryption also takes place within the binary
+  Red herrings of some kind are included within the binary.
+  First Stage contains a list of indexes that the binary could use in order to extract the PE file, and subsequently extract the encrypted file. 
+  Finally the flag can be generated by finding out the xxtea key that is being used from the Second Stage debugging it, and decrypting using xxtea ciphers.

### Flag

`bi0sctf{warmup_reversing_challenge_but_malware}`

### Author

+ **Sejal Koshta**: k1n0r4#0712
+ **Sidharth V**: retr0ds#2334
+ **Adhithya**:  AmunRha#6390
